# 即売会購入巡回表アプリ

即売会での購入リストを管理するWebアプリケーションです。タブレットやスマートフォン端末のホーム画面に追加してネイティブアプリのように使用できます。

## 📋 目次

- [概要](#概要)
- [画面の見方と操作](#画面の見方と操作)
- [主な機能](#主な機能)
- [使用方法](#使用方法)
- [セットアップ](#セットアップ)
- [データ管理](#データ管理)
- [注意事項](#注意事項)

## 概要

このアプリケーションは、即売会（コミケ、コミティアなど）での購入計画を効率的に管理するためのツールです。スプレッドシートから購入リストをインポートし、会場での巡回順序を最適化して、購入状況をリアルタイムで記録できます。

### 主な特徴

- **複数イベント管理**: 複数の即売会イベントを同時に管理可能
- **参加日別表示**: 参加日を分けて管理
- **編集モードと実行モード**: 事前計画と当日実行を切り替え可能
- **視認性の向上**: ブロック値ごとの色分けと購入状態の色表示により、会場での識別が容易
- **オフライン対応**: PWA対応により、インターネット接続なしでも動作
- **データの自動保存**: ブラウザに自動保存され、ページをリロードしても状態が保持される

## 画面の見方と操作

### 画面構成

#### ヘッダー
- **タイトル**: 「即売会 購入巡回表」
- **即売会名**: 現在選択中のイベント名が表示
- **タブ**: 「即売会リスト」「1日目」「2日目」など、参加日ごとのタブ
- **操作ボタン**: 
  - 編集モード時: ブロックソートボタン、選択アイテムの移動ボタン
  - 実行モード時: ブロックソートボタン、状態別フィルタボタン

#### アイテムカード
各アイテムはカード形式で表示され、以下の情報が含まれます：

- **左側**: 
  - チェックボックス（選択用）
  - 上下移動ボタン（順序変更用）
  - ドラッグハンドル（並び替え用）
- **中央**: 
  - 参加日とブロック-ナンバー（例: 「1日目 G-01a」）
  - サークル名
  - タイトル
  - 備考欄（編集可能）
- **右側**: 
  - 購入状態ボタン（タップで状態変更）
  - 価格表示・選択

#### 購入状態の表示
- **未購入**: 灰色の円アイコン
- **購入済**: 緑色のチェックマーク
- **売切**: 赤色の×マーク
- **欠席**: 黄色のマイナスマーク
- **後回し**: 紫色の一時停止マーク
- **遅参**: 青色の時計マーク

#### 色分け表示
- **ブロック色**: 未購入のアイテムは、ブロック値ごとに異なる色で表示されます
- **状態色**: 購入済み・売切・欠席などの状態は、背景色で識別できます
- **縞模様**: 同じブロック値のアイテムが隣り合う場合、濃淡が交互に表示されます

#### 編集モード（2列表示）
- **左列（実行モード表示列）**: 当日購入するアイテムを配置
- **右列（候補リスト）**: 候補となるアイテムを表示
  - ブロックフィルタボタンで特定のブロックのみ表示可能
  - ナンバーソートボタンで選択アイテムをソート可能

#### 実行モード（1列表示）
- **実行列**: 編集モードで左列に移動したアイテムのみ表示
- **サマリーバー**: 画面下部に購入済み件数と残りの合計金額を表示
- **状態別フィルタ**: ヘッダーのボタンで状態ごとにフィルタリング

#### ズームコントロール
- 画面左下にズーム選択ボタンが表示されます
- 30%, 50%, 75%, 100%, 125%, 150%から選択可能

### 基本操作

#### 長押し操作
- **タブの長押し（500ms）**: 編集モードと実行モードを切り替え
- **リストアイテムの長押し**: メニューを表示（更新、削除など）

#### ドラッグ&ドロップ
- アイテムカードの左側のドラッグハンドルをドラッグして順序を変更
- 画面端に近づくと自動スクロール
- 編集モード時は列間の移動も可能

#### 選択操作
- **個別選択**: チェックボックスをクリック
- **複数選択**: 複数のアイテムをチェックして一括操作
- **一括移動**: 選択したアイテムを「選択したアイテムを左列に移動」ボタンで移動

## 主な機能

### 1. リストの作成とインポート

#### スプレッドシートURLからインポート
- GoogleスプレッドシートのURLを入力して自動インポート
- ⚠️**重要**: スプレッドシートの「ファイル」→「共有」→「他のユーザーと共有」→「一般的なアクセス」で「リンクを知っている全員」「閲覧者」に設定してください
- シート名「品目表」のM列からR列とW列をインポート
  - M列: サークル名
  - N列: 参加日
  - O列: ブロック
  - P列: ナンバー
  - Q列: タイトル
  - R列: 頒布価格
  - W列: 備考

#### CSVファイルからインポート
- ローカルのCSVファイルをアップロード
- A列からD列の値が全て入力されている行のみをインポート
- または、M列から始まる形式（スプレッドシート形式）にも対応

#### 手動入力
- タブ区切りテキストを貼り付けて一括登録
- または個別にアイテムを追加

### 2. アイテム管理

- **購入状態の変更**: アイテムカード右側の状態ボタンをタップして6つの状態を切り替え
- **アイテムの編集**: アイテムを長押しして「編集」を選択
- **アイテムの削除**: アイテムを長押しして「削除」を選択
- **順序の変更**: ドラッグ&ドロップまたは上下移動ボタンで変更

### 3. 編集モードと実行モード

#### 編集モード
- 2列表示で、候補リストから実行モード表示列へアイテムを移動
- ブロックフィルタで特定のブロックのみ表示
- 選択したアイテムをナンバー順にソート
- 候補リストをブロック名でソート

#### 実行モード
- 実行列のアイテムのみ表示
- 状態別フィルタで購入状態ごとに表示
- ブロック名でソート
- サマリーバーで購入状況を確認

### 4. その他の機能

- **リスト更新**: スプレッドシートから最新データを取得して更新
- **CSVエクスポート**: リストをCSV形式でダウンロード
- **リスト名変更**: 即売会の名称を変更
- **リスト削除**: 不要なリストを削除

## 使用方法

### 新規リストの作成

1. 「新規リスト作成」タブを開く
2. 即売会名を入力
3. 以下のいずれかの方法でデータをインポート：
   - **スプレッドシートURL**: URLを入力して「URLからインポート」をクリック
   - **CSVファイル**: CSVファイルを選択してアップロード
   - **手動入力**: スプレッドシートのM列からR列とW列をコピーして「サークル名」欄に貼り付け（タブ区切りで自動振り分け）
4. 「リストを作成」をクリック

### アイテムの追加

1. 既存のリストを開く
2. 「アイテム追加」タブを開く
3. アイテム情報を入力
4. 「リストに追加」をクリック

### 編集モードでの操作

1. 参加日のタブを**長押し**（500ms）して編集モードに切り替え
2. 右側の候補リストから購入したいアイテムを選択（チェックボックスで複数選択可能）
3. ヘッダーの「選択したアイテムを左列に移動」ボタンをクリック
4. 左側の実行モード表示列でアイテムの順序をドラッグ&ドロップで調整
5. 候補リストでブロックフィルタを使用して、特定のブロックのアイテムのみを表示
6. 選択したアイテムをナンバー順にソート（昇順・降順切り替え可能）
7. 候補リストをブロック名でソート（昇順・降順切り替え可能）

### 実行モードでの操作

1. 参加日のタブを**長押し**（500ms）して実行モードに切り替え
2. 実行列のアイテムのみが表示されます
3. 各アイテムの購入状態ボタンをタップして状態を変更
4. ヘッダーのソートボタンで状態別にフィルタリング（巡回順、後回し、遅参、欠席、売切、購入済）
5. 下部のサマリーバーで購入済み件数と残りの合計金額を確認

### リストの更新

1. 即売会リスト画面で、更新したいリストを**長押し**
2. 「🔄 アイテム更新」を選択
3. スプレッドシートから最新データを取得
4. 変更内容を確認（削除・更新・追加のアイテムが表示される）
5. 確認ダイアログで「更新を確定」をクリック
6. スプレッドシートのURLが保存されていない場合は、URL更新ダイアログが表示される

### CSVエクスポート

1. 即売会リスト画面で、エクスポートしたいリストを**長押し**
2. 「Excel形式で出力」を選択
3. CSVファイルがダウンロードされます

## セットアップ

### 必要な環境

- Node.js 18以上
- npm または yarn

### インストール手順

1. リポジトリのクローンまたはダウンロード

2. 依存関係のインストール

```bash
npm install
```

3. 開発サーバーの起動

```bash
npm run dev
```

開発サーバーは `http://localhost:3000` で起動します。

4. 本番ビルド

```bash
npm run build
```

ビルドされたファイルは `dist/` ディレクトリに出力されます。

## データ管理

### データの保存

- すべてのデータはブラウザの**localStorage**に自動保存されます
- サーバーには送信されません（プライバシー保護）
- ページをリロードしても状態が保持されます

### データのバックアップ

- 定期的にCSV形式でエクスポートしてバックアップすることを推奨します
- ブラウザのデータをクリアすると、保存されたデータも削除されます

### データ形式

#### スプレッドシート形式（M列から始まる）
- M列: サークル名
- N列: 参加日（例: 1日目、2日目）
- O列: ブロック（例: A、G）
- P列: ナンバー（例: 01a、03a）
- Q列: タイトル
- R列: 頒布価格（数値）
- W列: 備考

#### CSVエクスポート形式（A列から始まる）
- A列: サークル名
- B列: 参加日
- C列: ブロック
- D列: ナンバー
- E列: タイトル
- F列: 頒布価格
- G列: 購入状態（未購入、購入済、売切、欠席、後回し、遅参）
- H列: 備考
- I列: 列の種類（実行列/候補リスト）
- J列: 列内順番

## 注意事項

- データはブラウザのローカルストレージに保存されます
- ブラウザのデータを削除すると、保存されたデータも失われます
- スプレッドシートは公開設定（「リンクを知っている全員が閲覧可」）にする必要があります
- 定期的なCSVエクスポートによるバックアップを推奨します

## ライセンス

MIT License
