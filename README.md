# イベント買い物プランナー

同人誌即売会などのイベントでの買い物計画を効率的に管理するためのWebアプリケーションです。

## 主な機能

- 📋 **買い物リスト管理** - サークル情報、頒布物の登録・編集
- 🗺️ **マップ表示** - 会場マップ上でサークル位置を可視化
- 🛣️ **ルート計画** - 効率的な巡回ルートの作成・編集
- 📱 **レスポンシブ対応** - PC・スマートフォン両対応
- 💾 **オフライン対応** - PWAとしてインストール可能

---

## 画面構成

### イベント一覧画面

アプリ起動時に表示される画面です。

- **新規イベント作成**: 「新規イベント」ボタンからイベントを追加
- **イベント選択**: イベント名をクリックして開く
- **イベント管理**: 各イベントの右側にある「⋮」メニューから編集・削除

### タブ構成

イベントを開くと、以下のタブが表示されます：

| タブ名 | 説明 |
|--------|------|
| 即売会リスト | 全日程のアイテムを一覧表示 |
| ○日目 | 各日のアイテムを候補列・実行列で管理 |
| ○日目マップ | 各日のマップ表示・ルート編集 |
| アイテム追加 | 新規アイテムの追加 |

---

## 基本操作

### アイテムの追加

1. 「アイテム追加」タブを開く
2. 各フィールドを入力
   - サークル名（必須）
   - 参加日
   - ブロック・ナンバー（例: A-01）
   - タイトル
   - 価格・数量
   - 備考
3. 「追加」ボタンをクリック

### アイテムの編集

- アイテムカードをクリックして編集モードに入る
- 各フィールドを編集後、「保存」ボタンで確定

### 購入ステータスの変更

アイテムカード右側のボタンで状態を変更：

| ステータス | 色 | 説明 |
|------------|-----|------|
| 未購入 | グレー | 初期状態 |
| 購入済 | 緑 | 購入完了 |
| 売切 | 赤 | 売り切れ |
| 不在 | 青 | サークル不在 |
| 後回し | 黄 | 後で購入予定 |
| 遅参 | 紫 | サークル遅刻 |

---

## ○日目タブの使い方

「○日目」タブでは、候補列と実行列の2列構成でアイテムを管理します。

### 表示モード

画面右上のトグルで切り替え：

- **編集モード**: 候補列と実行列の両方を表示
- **実行モード**: 実行列のみを大きく表示（当日用）

### 候補列 → 実行列への移動

1. 候補列でアイテムを選択（チェックボックス）
2. 選択したアイテムは自動的に実行列に追加

### 実行列の並べ替え

- ドラッグ＆ドロップで順序変更
- 複数選択してまとめて移動も可能

### 一括操作

複数アイテムを選択した状態で、画面上部のツールバーから：

- **ブロックソート**: 選択範囲をブロック・ナンバー順に並べ替え
- **ホールソート**: 選択範囲をホール順に並べ替え

---

## マップ機能

### マップの読み込み

1. 「○日目マップ」タブを開く
2. 「マップを読み込み」ボタンをクリック
3. Excelファイル（.xlsx）を選択

※ マップファイルはセルの背景色・罫線を使って会場レイアウトを表現したExcelファイルです。

### マップ上の操作

- **ズーム**: 右下のズームコントロールで拡大縮小（30%〜150%）
- **スクロール**: ドラッグで移動
- **セルタップ**: 該当位置のアイテム情報をポップアップ表示

### セルの色分け

| 色 | 状態 |
|----|------|
| 青枠 | アイテムあり（未訪問） |
| 緑背景 | 全アイテム購入済/チェック済 |
| 半透明緑 | 一部アイテムのみ購入済 |
| 黄黒ストライプ | 優先アイテムあり（未訪問） |

---

## ブロック定義

マップ上でサークル配置を認識させるための設定です。

### ブロック定義の開き方

「○日目マップ」タブを**長押し** → メニューから「ブロック定義」を選択

### ブロックの追加

1. 「ブロック追加」ボタンをクリック
2. ブロック名を入力（例: A, B, あ, い）
3. 「セル範囲を選択」をクリック
4. マップ上で対角の2セルをクリック
5. 数値セルが自動認識される

### ブロックの編集・削除

- 各ブロックの「編集」ボタンで範囲を再設定
- 「削除」ボタンでブロックを削除

---

## ホール定義

大規模会場で複数ホールがある場合のエリア分け設定です。

### ホール定義の開き方

「○日目マップ」タブを**長押し** → メニューから「ホール定義」を選択

### ホールの追加

1. 「ホール追加」ボタンをクリック
2. ホール名を入力（例: 東1, 西2）
3. 「頂点を選択」をクリック
4. マップ上でホールの頂点を4〜6箇所クリック（多角形を形成）
5. 「確定」をクリック

### ホール表示の切り替え

マップ右上のドロップダウンでホールを選択すると、そのホールのみ表示されます。

### ホール順序の設定

「ホール順序」ボタンで、ホール間の訪問順序をドラッグ＆ドロップで設定できます。

---

## 訪問先リスト（ルート編集）

マップを見ながら訪問順序を編集する機能です。

### 訪問先リストの開き方

「○日目マップ」タブを**長押し** → メニューから「訪問先リスト」を選択

### パネル表示

- **PCモード**: 画面右側（または左側）にサイドパネル表示
- **スマートフォンモード**: 画面下部からボトムシート表示

### 並べ替え方法

#### ドラッグ＆ドロップ
アイテム左側のグリップアイコンをドラッグして移動

#### 入れ替えモード
1. 「入れ替え」ボタンをクリック
2. 1つ目のアイテムをタップ
3. 2つ目のアイテムをタップ → 位置が入れ替わる

#### 区間反転
1. 「範囲選択」ボタンをクリック
2. 開始アイテムをタップ
3. 終了アイテムをタップ
4. 「区間反転」ボタンで選択範囲の順序を逆転

※ 全ホール表示時は、ホールを跨いだ範囲選択はできません

### Undo/Redo

パネルヘッダーの矢印ボタンで操作を取り消し/やり直し（最大30回）

### 確定/キャンセル

- **確定**: 変更を保存（パネルは開いたまま）
- **キャンセル**: パネルを開いてからの全変更を破棄
- **パネルを閉じる**: 変更は保持されるが未確定状態

---

## データ管理

### エクスポート

1. イベント一覧で対象イベントの「⋮」メニューを開く
2. 「エクスポート」を選択
3. エクスポートオプションを選択
   - **フル**: すべてのデータ（マップ、ルート含む）
   - **シンプル**: アイテムデータのみ
4. xlsxファイルがダウンロードされる

### インポート

1. イベント一覧で「インポート」ボタンをクリック
2. エクスポートしたxlsxファイルを選択
3. データが復元される

---

## レイアウトモード

画面下部のフッター右側にあるボタンでレイアウトを切り替え：

- **PCモード**: 標準レイアウト
- **スマートフォンモード**: モバイル向け最適化レイアウト
  - ボタンサイズ拡大
  - 操作エリアの配置変更
  - タッチ操作に最適化

---

## キーボードショートカット

| キー | 機能 |
|------|------|
| Ctrl + Z | 元に戻す（訪問先リスト編集時） |
| Ctrl + Y | やり直す（訪問先リスト編集時） |
| Escape | 編集モードを終了 |

---

## 優先アイテムの設定

備考欄に以下のキーワードを含めると、特別な表示になります：

| キーワード | 効果 |
|------------|------|
| 優先 | 優先アイコン表示、マップ上で警告表示 |
| 委託無 | 委託無アイコン表示、マップ上で警告表示 |

---

## トラブルシューティング

### データが保存されない

- ブラウザのプライベートモードでは、データが保存されない場合があります
- ブラウザの設定でIndexedDBが無効になっていないか確認してください

### マップが表示されない

- xlsxファイルの形式を確認してください
- セルに背景色や罫線が設定されているか確認してください

### アイテムがマップに表示されない

- ブロック定義が正しく設定されているか確認してください
- アイテムのブロック名・ナンバーがブロック定義と一致しているか確認してください
- ブロック名の大文字・小文字は区別されます（A ≠ a）

---

## 動作環境

### 推奨ブラウザ

- Google Chrome（最新版）
- Microsoft Edge（最新版）
- Safari（最新版）
- Firefox（最新版）

### PWAインストール

対応ブラウザでは、アドレスバーのインストールアイコンからアプリとしてインストール可能です。

---

## 技術情報

- **フレームワーク**: React 18 + TypeScript
- **スタイリング**: Tailwind CSS
- **データ保存**: IndexedDB
- **PWA**: Vite PWA Plugin

---

## ライセンス

MIT License
